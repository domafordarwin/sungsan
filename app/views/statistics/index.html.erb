<div class="max-w-4xl mx-auto">
  <div class="page-header animate-in">
    <h1>통계</h1>
    <div class="flex gap-2">
      <%= link_to "주간", statistics_path(period: "week"),
          class: "period-tab #{@period == 'week' ? 'active' : 'inactive'}" %>
      <%= link_to "월간", statistics_path(period: "month"),
          class: "period-tab #{@period == 'month' ? 'active' : 'inactive'}" %>
      <%= link_to "분기", statistics_path(period: "quarter"),
          class: "period-tab #{@period == 'quarter' ? 'active' : 'inactive'}" %>
    </div>
  </div>

  <!-- 핵심 지표 -->
  <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
    <div class="stat-card ocean animate-in animate-delay-1">
      <div class="stat-value"><%= @total_assignments %></div>
      <div class="stat-label">총 배정</div>
    </div>
    <div class="stat-card moss animate-in animate-delay-2">
      <div class="stat-value"><%= @participation_rate %>%</div>
      <div class="stat-label">참여율</div>
    </div>
    <div class="stat-card lava animate-in animate-delay-3">
      <div class="stat-value"><%= @absence_rate %>%</div>
      <div class="stat-label">결석률</div>
    </div>
    <div class="stat-card sunrise animate-in animate-delay-4">
      <div class="stat-value"><%= @accepted_count %></div>
      <div class="stat-label">수락 건수</div>
    </div>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- 월별 봉사 횟수 -->
    <div class="card-basalt animate-in" style="padding: 1.5rem;">
      <h3 class="section-title">월별 봉사 횟수 (최근 6개월)</h3>
      <table class="table-stone">
        <thead>
          <tr><th>월</th><th style="text-align: right;">수락 건수</th></tr>
        </thead>
        <tbody>
          <% @monthly_stats.each do |ms| %>
            <tr>
              <td><%= ms[:month] %></td>
              <td style="text-align: right; font-weight: 500; color: var(--ocean-700);"><%= ms[:count] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>

    <!-- 역할별 통계 -->
    <div class="card-basalt animate-in animate-delay-1" style="padding: 1.5rem;">
      <h3 class="section-title">역할별 배정 현황</h3>
      <table class="table-stone">
        <thead>
          <tr>
            <th>역할</th>
            <th style="text-align: right;">배정</th>
            <th style="text-align: right;">수락</th>
          </tr>
        </thead>
        <tbody>
          <% @role_stats.each do |rs| %>
            <tr>
              <td><%= rs[:role].name %></td>
              <td style="text-align: right;"><%= rs[:assigned] %></td>
              <td style="text-align: right; font-weight: 500; color: var(--moss-600);"><%= rs[:accepted] %></td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  </div>

  <div style="margin-top: 1.5rem;">
    <%= link_to "대시보드", root_path, class: "btn-ghost" %>
  </div>
</div>
