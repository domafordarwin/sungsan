<%= form_with model: member do |f| %>
  <% if member.errors.any? %>
    <div class="flash-alert" style="border-radius: 0.5rem; margin-bottom: 1.25rem;">
      <ul style="list-style: disc; padding-left: 1.25rem;">
        <% member.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-4" style="margin-bottom: 1.25rem;">
    <div>
      <label class="label-basalt">이름 *</label>
      <%= f.text_field :name, required: true, class: "input-basalt" %>
    </div>
    <div>
      <label class="label-basalt">세례명</label>
      <%= f.text_field :baptismal_name, class: "input-basalt" %>
    </div>
    <div>
      <label class="label-basalt">연락처</label>
      <%= f.telephone_field :phone, placeholder: "010-1234-5678", class: "input-basalt" %>
    </div>
    <div>
      <label class="label-basalt">이메일</label>
      <%= f.email_field :email, class: "input-basalt" %>
    </div>
    <div>
      <label class="label-basalt">생년월일</label>
      <%= f.date_field :birth_date, class: "input-basalt" %>
    </div>
    <div>
      <label class="label-basalt">성별</label>
      <%= f.select :gender, [["선택 안 함", ""], ["남", "M"], ["여", "F"]],
          {}, class: "input-basalt" %>
    </div>
    <div>
      <label class="label-basalt">구역</label>
      <%= f.text_field :district, class: "input-basalt" %>
    </div>
    <div>
      <label class="label-basalt">단체</label>
      <%= f.text_field :group_name, class: "input-basalt" %>
    </div>
  </div>

  <div style="display: flex; gap: 1.5rem; margin-bottom: 1.25rem;">
    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
      <%= f.check_box :baptized, style: "accent-color: var(--ocean-700);" %>
      <span style="font-size: 0.875rem; color: var(--basalt-700);">세례</span>
    </label>
    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
      <%= f.check_box :confirmed, style: "accent-color: var(--ocean-700);" %>
      <span style="font-size: 0.875rem; color: var(--basalt-700);">견진</span>
    </label>
  </div>

  <% if Current.user.admin? %>
    <div style="margin-bottom: 1.25rem;">
      <label class="label-basalt">연결 사용자 (선택)</label>
      <%= f.select :user_id, User.all.map { |u| [u.name, u.id] },
          { include_blank: "연결 안 함" }, class: "input-basalt" %>
    </div>
  <% end %>

  <div style="margin-bottom: 1.25rem;">
    <label class="label-basalt">메모</label>
    <%= f.text_area :notes, rows: 3, class: "input-basalt" %>
  </div>

  <div class="form-group" style="margin-bottom: 1.25rem;">
    <%= f.label :role_ids, "담당 가능 역할", class: "label-basalt" %>
    <div class="checkbox-group" style="display: flex; flex-wrap: wrap; gap: 0.75rem; margin-top: 0.5rem;">
      <% Role.active.ordered.each do |role| %>
        <div class="form-check" style="display: flex; align-items: center; gap: 0.375rem;">
          <%= check_box_tag "member[role_ids][]", role.id,
              @member.roles.include?(role),
              id: "role_#{role.id}",
              style: "accent-color: var(--ocean-700);" %>
          <%= label_tag "role_#{role.id}", role.name,
              style: "font-size: 0.875rem; color: var(--basalt-700); cursor: pointer;" %>
        </div>
      <% end %>
    </div>
    <%= f.hidden_field :role_ids, value: "" %>
  </div>

  <div style="display: flex; gap: 0.5rem;">
    <%= f.submit member.new_record? ? "등록" : "수정", class: "btn-ocean cursor-pointer" %>
    <%= link_to "취소", member.new_record? ? members_path : member_path(member), class: "btn-ghost" %>
  </div>
<% end %>
